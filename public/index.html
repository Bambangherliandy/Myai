<!-- <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BAMBANG AI</title>

<style>
    *{
    margin:0;
    padding:0;
    box-sizing:border-box;
  }
  
  body{
    font-family:'Inter','Segoe UI',sans-serif;
    background:
      radial-gradient(circle at top,#1a1f3c,#0b0f1a 60%),
      radial-gradient(circle at bottom,#050814,#000);
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    overflow:hidden;
    color:#eaeaff;
  }
  
  /* ðŸŒŒ STAR FIELD */
  body::before{
    content:"";
    position:absolute;
    inset:0;
    background:url("https://i.imgur.com/5cX1QkT.png");
    opacity:.18;
    animation:move 140s linear infinite;
    z-index:-1;
  }
  @keyframes move{
    to{background-position:-3000px 3000px}
  }
  
  /* ðŸ§  CONTAINER */
  .container{
    width:100%;
    max-width:920px;
    height:92vh;
    background:transparent;
    backdrop-filter:blur(2px);
    border-radius:28px;
    display:flex;
    flex-direction:column;
    overflow:hidden;
  }
  
  /* ðŸš€ HEADER */
  .header{
    padding:22px 26px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    background:linear-gradient(135deg,#101633,#1b2250);
    border-bottom:1px solid rgba(255,255,255,.08);
  }
  
  .header h1{
    font-size:22px;
    letter-spacing:1.4px;
    color:#00eaff;
  }
  
  .header p{
    font-size:13px;
    color:#b6c6ff;
  }
  
  /* ðŸ‘½ ALIEN */
  .alien{
    width:56px;
    height:56px;
    border-radius:50%;
    background:
      radial-gradient(circle at 30% 30%,#00eaff,#4a6cff,#2b1a7a);
    box-shadow:0 0 22px rgba(0,234,255,.9);
    position:relative;
    animation:float 3s ease-in-out infinite;
  }
  @keyframes float{
    50%{transform:translateY(-6px)}
  }
  .alien::before,.alien::after{
    content:"";
    position:absolute;
    top:20px;
    width:9px;
    height:12px;
    background:#050814;
    border-radius:50%;
  }
  .alien::before{left:16px}
  .alien::after{right:16px}
  
  /* ðŸ’¬ CHAT AREA */
  .chat-area{
    flex:1;
    padding:26px;
    overflow-y:auto;
  }
  
  .message{
    margin-bottom:18px;
    animation:fade .25s ease;
  }
  @keyframes fade{
    from{opacity:0;transform:translateY(8px)}
    to{opacity:1}
  }
  
  .message.user{text-align:right}
  
  /* LABEL (NAMA) */
  .message-label{
    font-size:12px;
    font-weight:600;
    margin-bottom:6px;
    letter-spacing:.5px;
  }
  
  /* TERANG & JELAS */
  .message.user .message-label{
    color:#cfd6ff;
  }
  .message.ai .message-label{
    color:#00eaff;
  }
  
  /* BUBBLE */
  .message-bubble{
    display:inline-block;
    max-width:76%;
    padding:14px 20px;
    border-radius:20px;
    font-size:15px;
    line-height:1.6;
  }
  
  /* USER */
  .message.user .message-bubble{
    background:linear-gradient(135deg,#6f7cff,#9b6cff);
    color:white;
    box-shadow:0 0 14px rgba(155,108,255,.6);
    border-bottom-right-radius:6px;
  }
  
  /* AI */
  .message.ai .message-bubble{
    background:#f4f6ff;
    color:#1a1d2e;
    box-shadow:0 4px 16px rgba(0,0,0,.15);
    border-bottom-left-radius:6px;
  }
  
  /* âŒ¨ INPUT */
  .input-area{
    padding:16px;
    display:flex;
    gap:12px;
    background:rgba(5,8,20,.85);
    border-top:1px solid rgba(255,255,255,.08);
  }
  
  #question{
    flex:1;
    padding:14px 20px;
    border-radius:28px;
    border:none;
    outline:none;
    font-size:15px;
    background:#0f1430;
    color:#fff;
  }
  #question::placeholder{
    color:#8fa3ff;
  }
  
  /* BUTTON */
  button{
    padding:14px 24px;
    border:none;
    border-radius:28px;
    font-weight:600;
    cursor:pointer;
    color:#001018;
    background:linear-gradient(135deg,#00eaff,#4facfe);
    box-shadow:0 0 18px rgba(0,234,255,.6);
    transition:.25s;
  }
  button:hover{
    transform:scale(1.06);
  }
  
  /* TYPING */
  .typing-indicator{
    display:flex;
    gap:6px;
    padding:14px 18px;
    background:#f4f6ff;
    border-radius:18px;
  }
  .typing-dot{
    width:8px;
    height:8px;
    background:#7c7cff;
    border-radius:50%;
    animation:pulse 1.4s infinite;
  }
  .typing-dot:nth-child(2){animation-delay:.2s}
  .typing-dot:nth-child(3){animation-delay:.4s}
  
  @keyframes pulse{
    0%,80%,100%{transform:scale(1)}
    40%{transform:scale(1.6)}
  }
  

@media(max-width:768px){
  body{
    height:100dvh;
  }

  .container{
    height:100dvh; 
    max-width:100%; 
    padding:3px; 
  }

  .welcome-message h2 {
    padding-left: 5px;
    padding-top: 10px;
    font-size: 20px;
    color: #00eaff;
    font-weight: 700;
    letter-spacing: 0.5px;
    margin-bottom: 4px;
}

.welcome-message p {
    padding-top: 3px;
    padding-left: 5px;
    color: rgb(199, 191, 191);
    font-size: 11px;
}

  .chat-area{
    padding:2px; 
  }

  .message-bubble{
    max-width:95%; 
    font-size:13px; 
    padding:8px 12px; 
  }

  #question{
    font-size:13px;
    padding:8px 12px; 
  }

  .typing-indicator{
    padding:8px 10px;
  }

  .typing-dot{
    width:6px;
    height:6px;
  }

  button{
    padding:10px 10px; 
    font-size:12px;
  }
}

</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div>
      <h1>Aitech AI</h1>
      <p>Space Technology Assistant</p>
    </div>
    <div class="alien"></div>
  </div>

  <div class="chat-area" id="chatArea">
    <div class="welcome-message">
      <h2 class="heading">Selamat datang âœ¨</h2>
      <p class="paragraf">Saya Aitech AI kamu, siap menemani eksplorasi digitalmu <br>dan menemukan solusi bersamaku</p>
    </div>
  </div>

  <div class="input-area">
    <input type="file" id="fileInput" style="display:none" onchange="handleFileSelect(event)">
    <input type="text" id="question" placeholder="Tanya apa ajaâ€¦ ðŸš€" onkeypress="if(event.key==='Enter') ask()">
    <button onclick="ask()" id="sendBtn">Send</button>
  </div>
</div>
    <script>
        let isFirstMessage = true;
        let selectedFile = null;

        // Handle file selection
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                selectedFile = file;
                const fileInfo = document.createElement('div');
                fileInfo.id = 'fileInfo';
                fileInfo.style.cssText = 'margin: 10px 0; padding: 10px; background: #e3f2fd; border-radius: 10px; font-size: 14px;';
                fileInfo.innerHTML = `ðŸ“Ž File dipilih: <strong>${file.name}</strong> (${(file.size / 1024).toFixed(2)} KB) <button onclick="clearFile()" style="margin-left: 10px; padding: 5px 10px; background: #ff5252; color: white; border: none; border-radius: 5px; cursor: pointer;">âœ• Hapus</button>`;
                
                const existing = document.getElementById('fileInfo');
                if (existing) existing.remove();
                
                document.querySelector('.input-area').insertBefore(fileInfo, document.querySelector('.input-area').firstChild);
            }
        }

        function clearFile() {
            selectedFile = null;
            document.getElementById('fileInput').value = '';
            const fileInfo = document.getElementById('fileInfo');
            if (fileInfo) fileInfo.remove();
        }

        async function ask() {
            const questionInput = document.getElementById("question");
            const question = questionInput.value.trim();
            const chatArea = document.getElementById("chatArea");
            const sendBtn = document.getElementById("sendBtn");

            if (!question && !selectedFile) return;

            // Hapus welcome message jika ada
            if (isFirstMessage) {
                chatArea.innerHTML = '';
                isFirstMessage = false;
            }

            // Tambah pesan user
            let userMessage = question || 'Analisis file ini';
            if (selectedFile) {
                userMessage += ` ðŸ“Ž ${selectedFile.name}`;
            }
            addMessage(userMessage, 'user');
            questionInput.value = '';
            sendBtn.disabled = true;

            // Tampilkan typing indicator
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'message ai';
            typingIndicator.innerHTML = `
                <div class="message-label">BAMBANG AI</div>
                <div class="typing-indicator active">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            `;
            chatArea.appendChild(typingIndicator);
            chatArea.scrollTop = chatArea.scrollHeight;

            try {
                let res, data;

                if (selectedFile) {
                    // Upload file
                    const formData = new FormData();
                    formData.append('file', selectedFile);
                    formData.append('question', question || 'Analisis file ini');

                    res = await fetch("/upload", {
                        method: "POST",
                        body: formData
                    });

                    clearFile();
                } else {
                    // Chat biasa
                    res = await fetch("/ask", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ question })
                    });
                }

                data = await res.json();
                
                // Hapus typing indicator
                typingIndicator.remove();

                // Tambah jawaban AI
                addMessage(data.answer || "Maaf, terjadi kesalahan.", 'ai');
            } catch (error) {
                typingIndicator.remove();
                addMessage("Maaf, terjadi kesalahan koneksi.", 'ai');
            }

            sendBtn.disabled = false;
            questionInput.focus();
        }

        function addMessage(text, sender) {
            const chatArea = document.getElementById("chatArea");
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const label = sender === 'user' ? 'Anda' : 'BAMBANG AI';
            messageDiv.innerHTML = `
                <div class="message-label">${label}</div>
                <div class="message-bubble">${text}</div>
            `;
            
            chatArea.appendChild(messageDiv);
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        // Focus input saat halaman load
        window.onload = () => {
            document.getElementById("question").focus();
        };
    </script>
</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BAMBANG AI</title>

<style>
    *{
    margin:0;
    padding:0;
    box-sizing:border-box;
  }
  
  body{
    font-family:'Inter','Segoe UI',sans-serif;
    background:
      radial-gradient(circle at top,#1a1f3c,#0b0f1a 60%),
      radial-gradient(circle at bottom,#050814,#000);
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    overflow:hidden;
    color:#eaeaff;
  }
  
  /* ðŸŒŒ STAR FIELD */
  body::before{
    content:"";
    position:absolute;
    inset:0;
    background:url("https://i.imgur.com/5cX1QkT.png");
    opacity:.18;
    animation:move 140s linear infinite;
    z-index:-1;
  }
  @keyframes move{
    to{background-position:-3000px 3000px}
  }
  
  /* ðŸ§  CONTAINER */
  .container{
    width:100%;
    max-width:920px;
    height:92vh;
    background:transparent;
    backdrop-filter:blur(2px);
    border-radius:28px;
    display:flex;
    flex-direction:column;
    overflow:hidden;
  }
  
  /* ðŸš€ HEADER */
  .header{
    padding:22px 26px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    background:linear-gradient(135deg,#101633,#1b2250);
    border-bottom:1px solid rgba(255,255,255,.08);
  }
  
  .header h1{
    font-size:22px;
    letter-spacing:1.4px;
    color:#00eaff;
  }
  
  .header p{
    font-size:13px;
    color:#b6c6ff;
  }
  
  /* ðŸ‘½ ALIEN */
  .alien{
    width:56px;
    height:56px;
    border-radius:50%;
    background:
      radial-gradient(circle at 30% 30%,#00eaff,#4a6cff,#2b1a7a);
    box-shadow:0 0 22px rgba(0,234,255,.9);
    position:relative;
    animation:float 3s ease-in-out infinite;
  }
  @keyframes float{
    50%{transform:translateY(-6px)}
  }
  .alien::before,.alien::after{
    content:"";
    position:absolute;
    top:20px;
    width:9px;
    height:12px;
    background:#050814;
    border-radius:50%;
  }
  .alien::before{left:16px}
  .alien::after{right:16px}
  
  /* ðŸ’¬ CHAT AREA */
  .chat-area{
    flex:1;
    padding:26px;
    overflow-y:auto;
  }
  
  .message{
    margin-bottom:18px;
    animation:fade .25s ease;
  }
  @keyframes fade{
    from{opacity:0;transform:translateY(8px)}
    to{opacity:1}
  }
  
  .message.user{text-align:right}
  
  /* LABEL (NAMA) */
  .message-label{
    font-size:12px;
    font-weight:600;
    margin-bottom:6px;
    letter-spacing:.5px;
  }
  
  /* TERANG & JELAS */
  .message.user .message-label{
    color:#cfd6ff;
  }
  .message.ai .message-label{
    color:#00eaff;
  }
  
  /* BUBBLE */
  .message-bubble{
    display:inline-block;
    max-width:76%;
    padding:14px 20px;
    border-radius:20px;
    font-size:15px;
    line-height:1.6;
    white-space:pre-wrap; /* âœ… Preserve line breaks */
    word-wrap:break-word;
  }
  
  /* USER */
  .message.user .message-bubble{
    background:linear-gradient(135deg,#6f7cff,#9b6cff);
    color:white;
    box-shadow:0 0 14px rgba(155,108,255,.6);
    border-bottom-right-radius:6px;
  }
  
  /* AI */
  .message.ai .message-bubble{
    background:#f4f6ff;
    color:#1a1d2e;
    box-shadow:0 4px 16px rgba(0,0,0,.15);
    border-bottom-left-radius:6px;
  }

  /* âœ¨ FORMATTING SUPPORT */
  .message-bubble strong{
    color:#4a6cff;
    font-weight:700;
  }

  .message-bubble em{
    font-style:italic;
    color:#555;
  }

  .message-bubble code{
    background:#e8eeff;
    color:#d73a49;
    padding:2px 7px;
    border-radius:4px;
    font-family:'Courier New',monospace;
    font-size:0.9em;
  }

  .message-bubble pre{
    background:#1e1e2e;
    color:#f8f8f2;
    padding:14px;
    border-radius:8px;
    overflow-x:auto;
    margin:10px 0;
    font-family:'Courier New',monospace;
    font-size:0.9em;
  }

  .message-bubble pre code{
    background:none;
    padding:0;
    color:inherit;
    font-size:1em;
  }

  .message-bubble a{
    color:#00eaff;
    text-decoration:none;
    border-bottom:1px solid #00eaff;
    transition:all .3s;
  }

  .message-bubble a:hover{
    border-bottom:2px solid #00eaff;
  }
  
  /* âŒ¨ INPUT */
  .input-area{
    padding:16px;
    display:flex;
    gap:12px;
    background:rgba(5,8,20,.85);
    border-top:1px solid rgba(255,255,255,.08);
  }
  
  #question{
    flex:1;
    padding:14px 20px;
    border-radius:28px;
    border:none;
    outline:none;
    font-size:15px;
    background:#0f1430;
    color:#fff;
  }
  #question::placeholder{
    color:#8fa3ff;
  }
  
  /* BUTTON */
  button{
    padding:14px 24px;
    border:none;
    border-radius:28px;
    font-weight:600;
    cursor:pointer;
    color:#001018;
    background:linear-gradient(135deg,#00eaff,#4facfe);
    box-shadow:0 0 18px rgba(0,234,255,.6);
    transition:.25s;
  }
  button:hover{
    transform:scale(1.06);
  }
  
  /* TYPING */
  .typing-indicator{
    display:flex;
    gap:6px;
    padding:14px 18px;
    background:#f4f6ff;
    border-radius:18px;
  }
  .typing-dot{
    width:8px;
    height:8px;
    background:#7c7cff;
    border-radius:50%;
    animation:pulse 1.4s infinite;
  }
  .typing-dot:nth-child(2){animation-delay:.2s}
  .typing-dot:nth-child(3){animation-delay:.4s}
  
  @keyframes pulse{
    0%,80%,100%{transform:scale(1)}
    40%{transform:scale(1.6)}
  }
  

@media(max-width:768px){
  body{
    height:100dvh;
  }

  .container{
    height:100dvh; 
    max-width:100%; 
    padding:3px; 
  }

  .welcome-message h2 {
    padding-left: 5px;
    padding-top: 10px;
    font-size: 20px;
    color: #00eaff;
    font-weight: 700;
    letter-spacing: 0.5px;
    margin-bottom: 4px;
}

.welcome-message p {
    padding-top: 3px;
    padding-left: 5px;
    color: rgb(199, 191, 191);
    font-size: 11px;
}

  .chat-area{
    padding:2px; 
  }

  .message-bubble{
    max-width:95%; 
    font-size:13px; 
    padding:8px 12px; 
  }

  #question{
    font-size:13px;
    padding:8px 12px; 
  }

  .typing-indicator{
    padding:8px 10px;
  }

  .typing-dot{
    width:6px;
    height:6px;
  }

  button{
    padding:10px 10px; 
    font-size:12px;
  }
}

</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div>
      <h1>Aitech AI</h1>
      <p>Space Technology Assistant</p>
    </div>
    <div class="alien"></div>
  </div>

  <div class="chat-area" id="chatArea">
    <div class="welcome-message">
      <h2 class="heading">Selamat datang âœ¨</h2>
      <p class="paragraf">Saya Aitech AI kamu, siap menemani eksplorasi digitalmu <br>dan menemukan solusi bersamaku</p>
    </div>
  </div>

  <div class="input-area">
    <input type="file" id="fileInput" style="display:none" onchange="handleFileSelect(event)">
    <input type="text" id="question" placeholder="Tanya apa ajaâ€¦ ðŸš€" onkeypress="if(event.key==='Enter') ask()">
    <button onclick="ask()" id="sendBtn">Send</button>
  </div>
</div>
    <script>
        let isFirstMessage = true;
        let selectedFile = null;

        // Handle file selection
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                selectedFile = file;
                const fileInfo = document.createElement('div');
                fileInfo.id = 'fileInfo';
                fileInfo.style.cssText = 'margin: 10px 0; padding: 10px; background: #e3f2fd; border-radius: 10px; font-size: 14px;';
                fileInfo.innerHTML = `ðŸ“Ž File dipilih: <strong>${file.name}</strong> (${(file.size / 1024).toFixed(2)} KB) <button onclick="clearFile()" style="margin-left: 10px; padding: 5px 10px; background: #ff5252; color: white; border: none; border-radius: 5px; cursor: pointer;">âœ• Hapus</button>`;
                
                const existing = document.getElementById('fileInfo');
                if (existing) existing.remove();
                
                document.querySelector('.input-area').insertBefore(fileInfo, document.querySelector('.input-area').firstChild);
            }
        }

        function clearFile() {
            selectedFile = null;
            document.getElementById('fileInput').value = '';
            const fileInfo = document.getElementById('fileInfo');
            if (fileInfo) fileInfo.remove();
        }

        async function ask() {
            const questionInput = document.getElementById("question");
            const question = questionInput.value.trim();
            const chatArea = document.getElementById("chatArea");
            const sendBtn = document.getElementById("sendBtn");

            if (!question && !selectedFile) return;

            // Hapus welcome message jika ada
            if (isFirstMessage) {
                chatArea.innerHTML = '';
                isFirstMessage = false;
            }

            // Tambah pesan user
            let userMessage = question || 'Analisis file ini';
            if (selectedFile) {
                userMessage += ` ðŸ“Ž ${selectedFile.name}`;
            }
            addMessage(userMessage, 'user');
            questionInput.value = '';
            sendBtn.disabled = true;

            // Tampilkan typing indicator
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'message ai';
            typingIndicator.innerHTML = `
                <div class="message-label">Aitech AI</div>
                <div class="typing-indicator active">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            `;
            chatArea.appendChild(typingIndicator);
            chatArea.scrollTop = chatArea.scrollHeight;

            try {
                let res, data;

                if (selectedFile) {
                    // Upload file
                    const formData = new FormData();
                    formData.append('file', selectedFile);
                    formData.append('question', question || 'Analisis file ini');

                    res = await fetch("/upload", {
                        method: "POST",
                        body: formData
                    });

                    clearFile();
                } else {
                    // Chat biasa
                    res = await fetch("/ask", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ question })
                    });
                }

                data = await res.json();
                
                // Hapus typing indicator
                typingIndicator.remove();

                // Tambah jawaban AI
                addMessage(data.answer || "Maaf, terjadi kesalahan.", 'ai');
            } catch (error) {
                typingIndicator.remove();
                addMessage("Maaf, terjadi kesalahan koneksi.", 'ai');
            }

            sendBtn.disabled = false;
            questionInput.focus();
        }

        function addMessage(text, sender) {
            const chatArea = document.getElementById("chatArea");
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const label = sender === 'user' ? 'Anda' : 'Aitech AI';
            
            // âœ¨ FORMAT TEXT: Convert markdown ke HTML
            let formattedText = text
                // Code block (```code```) - harus sebelum inline code
                .replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>')
                // Inline code (`code`)
                .replace(/`([^`]+)`/g, '<code>$1</code>')
                // Bold (**text**)
                .replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>')
                // Italic (*text*)
                .replace(/\*([^*]+)\*/g, '<em>$1</em>')
                // Line breaks (\n)
                .replace(/\n/g, '<br>')
                // Auto-link URLs
                .replace(/(https?:\/\/[^\s<]+)/g, '<a href="$1" target="_blank" rel="noopener">$1</a>');
            
            messageDiv.innerHTML = `
                <div class="message-label">${label}</div>
                <div class="message-bubble">${formattedText}</div>
            `;
            
            chatArea.appendChild(messageDiv);
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        // Focus input saat halaman load
        window.onload = () => {
            document.getElementById("question").focus();
        };
    </script>
</body>
</html>